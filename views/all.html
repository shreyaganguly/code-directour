<div class="container" style="padding:20px;">
  {{ if ne .ErrorMessage ""}}
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <strong>{{ .ErrorMessage }}</strong>
    </div>
  {{ end }}
  <a class="btn btn-sm btn-primary float-right" style="margin-bottom:8px;margin-left:8px;" href="/index">Home</a>
  <a class="btn btn-sm btn-primary float-right" style="margin-bottom:8px;margin-left:8px;" href="/new">New snippet</a>
  {{ $length := len .SnippetInfos }} {{ if eq $length 0 }}
  <div class="card" style="width:100%;text-align:center;margin-top:100px; ">
    <h3 style="text-align:center;margin:100px;"> No Snippets Found! </h3>
  </div>
  {{ end }}
  {{ range .SnippetInfos }}
    <div class="card" style="width: 100%;">
    <div class="card-body">
      <h5 class="card-title">{{ .Title }}</h5>
      <h6 class="card-subtitle mb-2 text-muted">In {{ .Language }}
      <div class="tooltip" style="opacity: 1 !important;">
        <span class="tooltiptext" id="copyTooltip">Copy Code!</span>
        <span style="margin:15px; cursor:pointer;" onclick="copyToClipboard()" onmouseout="outFunc()"><i class="fa fa-copy" aria-hidden="true"></i>
        </span>
      </div>
      </h6>
      <pre><code class="card-text" id="code" class={{ .Language | getCode }}>{{.Code}}</code></pre>
      <a href="{{.References}}" target="_blank" class="card-link">{{.References}}</a>
      <div class="card-body">
        <a href="/edit/{{ .Key }}" class="btn btn-primary">Edit</a>
        <a href="/delete/{{ .Key }}" class="btn btn-primary" id="delete">Delete</a>
        <a href="#" class="btn btn-primary" style="cursor: pointer;" data-toggle="modal" data-target="#shareModal" id="share" data-key="{{ .Key }}">Share with code-directour user</a>
      </div>
    </div>
    </div>
  {{ end }}
</div>
<!-- Modal -->
<div class="modal fade" id="shareModal" tabindex="-1" role="dialog" aria-labelledby="shareModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="shareModalLabel">Share With</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form action="" id="test" method="POST">
          <div class="form-group">
            <label for="recipient-name" class="col-form-label">Share With:</label>
            <input type="text" name="recepient" class="form-control" id="shared-with">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary">Save changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<script>
hljs.initHighlightingOnLoad();
var recepientform;
window.onload = function() {
        recepientform = document.getElementById("test");
    }

function copyToClipboard() {
  var tooltip = document.getElementById("copyTooltip");
  tooltip.innerHTML = "Copied!";
  var $temp = $("<input>");
  $("body").append($temp);
  $temp.val($("#code").text()).select();
  document.execCommand("copy");
  $temp.remove();
}
function outFunc() {
  var tooltip = document.getElementById("copyTooltip");
  tooltip.innerHTML = "Copy Code!";
}
$('#shareModal').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget)
  var recepient = button.data('key')
  recepientform.action = "/share/"+ recepient;
})

</script>
</script>
